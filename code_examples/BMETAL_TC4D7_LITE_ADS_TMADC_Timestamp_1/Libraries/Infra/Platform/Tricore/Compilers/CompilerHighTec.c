/**
 * \file CompilerHighTec.c.h
 * \brief Startup Software configuration. Can configure which core to be enabled.
 *
 * \version iLLD-TC4-v2.2.0
 * \copyright Copyright (c) 2020 Infineon Technologies AG. All rights reserved.
 *
 *
 *                                 IMPORTANT NOTICE
 *
 *
 * Use of this file is subject to the terms of use agreed between (i) you or
 * the company in which ordinary course of business you are acting and (ii)
 * Infineon Technologies AG or its licensees. If and as long as no such
 * terms of use are agreed, use of this file is subject to following:
 *
 *
 * Boost Software License - Version 1.0 - August 17th, 2003
 *
 * Permission is hereby granted, free of charge, to any person or
 * organization obtaining a copy of the software and accompanying
 * documentation covered by this license (the "Software") to use, reproduce,
 * display, distribute, execute, and transmit the Software, and to prepare
 * derivative works of the Software, and to permit third-parties to whom the
 * Software is furnished to do so, all subject to the following:
 *
 * The copyright notices in the Software and this entire statement, including
 * the above license grant, this restriction and the following disclaimer, must
 * be included in all copies of the Software, in whole or in part, and all
 * derivative works of the Software, unless such copies or derivative works are
 * solely in the form of machine-executable object code generated by a source
 * language processor.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
 * SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
 * FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
 * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 *
 */

/*******************************************************************************
**                      Includes                                              **
*******************************************************************************/
#include "Ifx_Ssw.h"

/******************************************************************************/
/*                          Macros                                            */
/******************************************************************************/

#if defined(__HIGHTEC__) && defined(IFX_USE_COMPILER_CONSTRUCTED_INT)

#ifdef STR
#undef STR
#endif

#define STR(x) #x

/* Interrupt table entry name as string. */
#define ITE_NAME(cpu, prio) \
  "__inttab_entry_" STR(cpu) "_" STR(prio)

/* Interrupt handler name as string. */
#define IH_NAME(cpu, prio) \
  "__interrupt_handler_" STR(cpu) "_" STR(prio)

/* asm fragment to declare a weak symbol for a specific interrupt handler. */
#ifdef HND_S
#undef HND_S
#endif
#define HND_S(cpu, prio) \
  "    .weak " IH_NAME(cpu, prio) "\n" \
  "    .type " IH_NAME(cpu, prio) ", @function\n" \
  IH_NAME(cpu, prio) ":\n"


/* Interrupt table entry */
#ifdef ITE
#undef ITE
#endif
#define ITE(cpu, prio) \
  "    .align 5\n" \
  "    .global " ITE_NAME(cpu, prio) "\n" \
  "    .type " ITE_NAME(cpu, prio) ", @function\n" \
  ITE_NAME(cpu, prio) ":\n" \
  "    svlcx\n" \
  "    movh.a  %a14, hi:" IH_NAME(cpu, prio) "\n" \
  "    lea     %a14, [%a14]lo:" IH_NAME(cpu, prio) "\n" \
  "    ji      %a14\n" \
  "    .align 5\n" \
  "    .size " ITE_NAME(cpu, prio) ", .-" ITE_NAME(cpu, prio) "\n" \


/* Constructs the interrupt table for a specific cpu. */
#define INTTAB(cpu) \
  __asm( \
    ".pushsection .inttab_tc" STR(cpu) ",\"ax\",@progbits\n" \
    "    .align 8\n" \
    "    .global __INTTAB_CPU" STR(cpu) "\n" \
    "    .type __INTTAB_CPU" STR(cpu) ", @object\n" \
    "__INTTAB_CPU" STR(cpu) ":\n" \
    ITE(cpu, 0)    ITE(cpu, 1)    ITE(cpu, 2)    ITE(cpu, 3) \
    ITE(cpu, 4)    ITE(cpu, 5)    ITE(cpu, 6)    ITE(cpu, 7) \
    ITE(cpu, 8)    ITE(cpu, 9)    ITE(cpu, 10)   ITE(cpu, 11) \
    ITE(cpu, 12)   ITE(cpu, 13)   ITE(cpu, 14)   ITE(cpu, 15) \
    ITE(cpu, 16)   ITE(cpu, 17)   ITE(cpu, 18)   ITE(cpu, 19) \
    ITE(cpu, 20)   ITE(cpu, 21)   ITE(cpu, 22)   ITE(cpu, 23) \
    ITE(cpu, 24)   ITE(cpu, 25)   ITE(cpu, 26)   ITE(cpu, 27) \
    ITE(cpu, 28)   ITE(cpu, 29)   ITE(cpu, 30)   ITE(cpu, 31) \
    ITE(cpu, 32)   ITE(cpu, 33)   ITE(cpu, 34)   ITE(cpu, 35) \
    ITE(cpu, 36)   ITE(cpu, 37)   ITE(cpu, 38)   ITE(cpu, 39) \
    ITE(cpu, 40)   ITE(cpu, 41)   ITE(cpu, 42)   ITE(cpu, 43) \
    ITE(cpu, 44)   ITE(cpu, 45)   ITE(cpu, 46)   ITE(cpu, 47) \
    ITE(cpu, 48)   ITE(cpu, 49)   ITE(cpu, 50)   ITE(cpu, 51) \
    ITE(cpu, 52)   ITE(cpu, 53)   ITE(cpu, 54)   ITE(cpu, 55) \
    ITE(cpu, 56)   ITE(cpu, 57)   ITE(cpu, 58)   ITE(cpu, 59) \
    ITE(cpu, 60)   ITE(cpu, 61)   ITE(cpu, 62)   ITE(cpu, 63) \
    ITE(cpu, 64)   ITE(cpu, 65)   ITE(cpu, 66)   ITE(cpu, 67) \
    ITE(cpu, 68)   ITE(cpu, 69)   ITE(cpu, 70)   ITE(cpu, 71) \
    ITE(cpu, 72)   ITE(cpu, 73)   ITE(cpu, 74)   ITE(cpu, 75) \
    ITE(cpu, 76)   ITE(cpu, 77)   ITE(cpu, 78)   ITE(cpu, 79) \
    ITE(cpu, 80)   ITE(cpu, 81)   ITE(cpu, 82)   ITE(cpu, 83) \
    ITE(cpu, 84)   ITE(cpu, 85)   ITE(cpu, 86)   ITE(cpu, 87) \
    ITE(cpu, 88)   ITE(cpu, 89)   ITE(cpu, 90)   ITE(cpu, 91) \
    ITE(cpu, 92)   ITE(cpu, 93)   ITE(cpu, 94)   ITE(cpu, 95) \
    ITE(cpu, 96)   ITE(cpu, 97)   ITE(cpu, 98)   ITE(cpu, 99) \
    ITE(cpu, 100)  ITE(cpu, 101)  ITE(cpu, 102)  ITE(cpu, 103) \
    ITE(cpu, 104)  ITE(cpu, 105)  ITE(cpu, 106)  ITE(cpu, 107) \
    ITE(cpu, 108)  ITE(cpu, 109)  ITE(cpu, 110)  ITE(cpu, 111) \
    ITE(cpu, 112)  ITE(cpu, 113)  ITE(cpu, 114)  ITE(cpu, 115) \
    ITE(cpu, 116)  ITE(cpu, 117)  ITE(cpu, 118)  ITE(cpu, 119) \
    ITE(cpu, 120)  ITE(cpu, 121)  ITE(cpu, 122)  ITE(cpu, 123) \
    ITE(cpu, 124)  ITE(cpu, 125)  ITE(cpu, 126)  ITE(cpu, 127) \
    ITE(cpu, 128)  ITE(cpu, 129)  ITE(cpu, 130)  ITE(cpu, 131) \
    ITE(cpu, 132)  ITE(cpu, 133)  ITE(cpu, 134)  ITE(cpu, 135) \
    ITE(cpu, 136)  ITE(cpu, 137)  ITE(cpu, 138)  ITE(cpu, 139) \
    ITE(cpu, 140)  ITE(cpu, 141)  ITE(cpu, 142)  ITE(cpu, 143) \
    ITE(cpu, 144)  ITE(cpu, 145)  ITE(cpu, 146)  ITE(cpu, 147) \
    ITE(cpu, 148)  ITE(cpu, 149)  ITE(cpu, 150)  ITE(cpu, 151) \
    ITE(cpu, 152)  ITE(cpu, 153)  ITE(cpu, 154)  ITE(cpu, 155) \
    ITE(cpu, 156)  ITE(cpu, 157)  ITE(cpu, 158)  ITE(cpu, 159) \
    ITE(cpu, 160)  ITE(cpu, 161)  ITE(cpu, 162)  ITE(cpu, 163) \
    ITE(cpu, 164)  ITE(cpu, 165)  ITE(cpu, 166)  ITE(cpu, 167) \
    ITE(cpu, 168)  ITE(cpu, 169)  ITE(cpu, 170)  ITE(cpu, 171) \
    ITE(cpu, 172)  ITE(cpu, 173)  ITE(cpu, 174)  ITE(cpu, 175) \
    ITE(cpu, 176)  ITE(cpu, 177)  ITE(cpu, 178)  ITE(cpu, 179) \
    ITE(cpu, 180)  ITE(cpu, 181)  ITE(cpu, 182)  ITE(cpu, 183) \
    ITE(cpu, 184)  ITE(cpu, 185)  ITE(cpu, 186)  ITE(cpu, 187) \
    ITE(cpu, 188)  ITE(cpu, 189)  ITE(cpu, 190)  ITE(cpu, 191) \
    ITE(cpu, 192)  ITE(cpu, 193)  ITE(cpu, 194)  ITE(cpu, 195) \
    ITE(cpu, 196)  ITE(cpu, 197)  ITE(cpu, 198)  ITE(cpu, 199) \
    ITE(cpu, 200)  ITE(cpu, 201)  ITE(cpu, 202)  ITE(cpu, 203) \
    ITE(cpu, 204)  ITE(cpu, 205)  ITE(cpu, 206)  ITE(cpu, 207) \
    ITE(cpu, 208)  ITE(cpu, 209)  ITE(cpu, 210)  ITE(cpu, 211) \
    ITE(cpu, 212)  ITE(cpu, 213)  ITE(cpu, 214)  ITE(cpu, 215) \
    ITE(cpu, 216)  ITE(cpu, 217)  ITE(cpu, 218)  ITE(cpu, 219) \
    ITE(cpu, 220)  ITE(cpu, 221)  ITE(cpu, 222)  ITE(cpu, 223) \
    ITE(cpu, 224)  ITE(cpu, 225)  ITE(cpu, 226)  ITE(cpu, 227) \
    ITE(cpu, 228)  ITE(cpu, 229)  ITE(cpu, 230)  ITE(cpu, 231) \
    ITE(cpu, 232)  ITE(cpu, 233)  ITE(cpu, 234)  ITE(cpu, 235) \
    ITE(cpu, 236)  ITE(cpu, 237)  ITE(cpu, 238)  ITE(cpu, 239) \
    ITE(cpu, 240)  ITE(cpu, 241)  ITE(cpu, 242)  ITE(cpu, 243) \
    ITE(cpu, 244)  ITE(cpu, 245)  ITE(cpu, 246)  ITE(cpu, 247) \
    ITE(cpu, 248)  ITE(cpu, 249)  ITE(cpu, 250)  ITE(cpu, 251) \
    ITE(cpu, 252)  ITE(cpu, 253)  ITE(cpu, 254)  ITE(cpu, 255) \
    "    .size __INTTAB_CPU" STR(cpu) ", .-__INTTAB_CPU" STR(cpu) "\n" \
    ".popsection\n" \
  ); \
  __asm( \
    ".pushsection .CPU" STR(cpu) ".text.default_int_handler,\"ax\",@progbits\n" \
    "    .align 2\n" \
    "    .global __default_int_handler_cpu" #cpu "\n" \
    "    .type __default_int_handler_cpu" #cpu ", @function\n" \
    "__default_int_handler_cpu" #cpu ":\n" \
    HND_S(cpu, 0)    HND_S(cpu, 1)    HND_S(cpu, 2)    HND_S(cpu, 3) \
    HND_S(cpu, 4)    HND_S(cpu, 5)    HND_S(cpu, 6)    HND_S(cpu, 7) \
    HND_S(cpu, 8)    HND_S(cpu, 9)    HND_S(cpu, 10)   HND_S(cpu, 11) \
    HND_S(cpu, 12)   HND_S(cpu, 13)   HND_S(cpu, 14)   HND_S(cpu, 15) \
    HND_S(cpu, 16)   HND_S(cpu, 17)   HND_S(cpu, 18)   HND_S(cpu, 19) \
    HND_S(cpu, 20)   HND_S(cpu, 21)   HND_S(cpu, 22)   HND_S(cpu, 23) \
    HND_S(cpu, 24)   HND_S(cpu, 25)   HND_S(cpu, 26)   HND_S(cpu, 27) \
    HND_S(cpu, 28)   HND_S(cpu, 29)   HND_S(cpu, 30)   HND_S(cpu, 31) \
    HND_S(cpu, 32)   HND_S(cpu, 33)   HND_S(cpu, 34)   HND_S(cpu, 35) \
    HND_S(cpu, 36)   HND_S(cpu, 37)   HND_S(cpu, 38)   HND_S(cpu, 39) \
    HND_S(cpu, 40)   HND_S(cpu, 41)   HND_S(cpu, 42)   HND_S(cpu, 43) \
    HND_S(cpu, 44)   HND_S(cpu, 45)   HND_S(cpu, 46)   HND_S(cpu, 47) \
    HND_S(cpu, 48)   HND_S(cpu, 49)   HND_S(cpu, 50)   HND_S(cpu, 51) \
    HND_S(cpu, 52)   HND_S(cpu, 53)   HND_S(cpu, 54)   HND_S(cpu, 55) \
    HND_S(cpu, 56)   HND_S(cpu, 57)   HND_S(cpu, 58)   HND_S(cpu, 59) \
    HND_S(cpu, 60)   HND_S(cpu, 61)   HND_S(cpu, 62)   HND_S(cpu, 63) \
    HND_S(cpu, 64)   HND_S(cpu, 65)   HND_S(cpu, 66)   HND_S(cpu, 67) \
    HND_S(cpu, 68)   HND_S(cpu, 69)   HND_S(cpu, 70)   HND_S(cpu, 71) \
    HND_S(cpu, 72)   HND_S(cpu, 73)   HND_S(cpu, 74)   HND_S(cpu, 75) \
    HND_S(cpu, 76)   HND_S(cpu, 77)   HND_S(cpu, 78)   HND_S(cpu, 79) \
    HND_S(cpu, 80)   HND_S(cpu, 81)   HND_S(cpu, 82)   HND_S(cpu, 83) \
    HND_S(cpu, 84)   HND_S(cpu, 85)   HND_S(cpu, 86)   HND_S(cpu, 87) \
    HND_S(cpu, 88)   HND_S(cpu, 89)   HND_S(cpu, 90)   HND_S(cpu, 91) \
    HND_S(cpu, 92)   HND_S(cpu, 93)   HND_S(cpu, 94)   HND_S(cpu, 95) \
    HND_S(cpu, 96)   HND_S(cpu, 97)   HND_S(cpu, 98)   HND_S(cpu, 99) \
    HND_S(cpu, 100)  HND_S(cpu, 101)  HND_S(cpu, 102)  HND_S(cpu, 103) \
    HND_S(cpu, 104)  HND_S(cpu, 105)  HND_S(cpu, 106)  HND_S(cpu, 107) \
    HND_S(cpu, 108)  HND_S(cpu, 109)  HND_S(cpu, 110)  HND_S(cpu, 111) \
    HND_S(cpu, 112)  HND_S(cpu, 113)  HND_S(cpu, 114)  HND_S(cpu, 115) \
    HND_S(cpu, 116)  HND_S(cpu, 117)  HND_S(cpu, 118)  HND_S(cpu, 119) \
    HND_S(cpu, 120)  HND_S(cpu, 121)  HND_S(cpu, 122)  HND_S(cpu, 123) \
    HND_S(cpu, 124)  HND_S(cpu, 125)  HND_S(cpu, 126)  HND_S(cpu, 127) \
    HND_S(cpu, 128)  HND_S(cpu, 129)  HND_S(cpu, 130)  HND_S(cpu, 131) \
    HND_S(cpu, 132)  HND_S(cpu, 133)  HND_S(cpu, 134)  HND_S(cpu, 135) \
    HND_S(cpu, 136)  HND_S(cpu, 137)  HND_S(cpu, 138)  HND_S(cpu, 139) \
    HND_S(cpu, 140)  HND_S(cpu, 141)  HND_S(cpu, 142)  HND_S(cpu, 143) \
    HND_S(cpu, 144)  HND_S(cpu, 145)  HND_S(cpu, 146)  HND_S(cpu, 147) \
    HND_S(cpu, 148)  HND_S(cpu, 149)  HND_S(cpu, 150)  HND_S(cpu, 151) \
    HND_S(cpu, 152)  HND_S(cpu, 153)  HND_S(cpu, 154)  HND_S(cpu, 155) \
    HND_S(cpu, 156)  HND_S(cpu, 157)  HND_S(cpu, 158)  HND_S(cpu, 159) \
    HND_S(cpu, 160)  HND_S(cpu, 161)  HND_S(cpu, 162)  HND_S(cpu, 163) \
    HND_S(cpu, 164)  HND_S(cpu, 165)  HND_S(cpu, 166)  HND_S(cpu, 167) \
    HND_S(cpu, 168)  HND_S(cpu, 169)  HND_S(cpu, 170)  HND_S(cpu, 171) \
    HND_S(cpu, 172)  HND_S(cpu, 173)  HND_S(cpu, 174)  HND_S(cpu, 175) \
    HND_S(cpu, 176)  HND_S(cpu, 177)  HND_S(cpu, 178)  HND_S(cpu, 179) \
    HND_S(cpu, 180)  HND_S(cpu, 181)  HND_S(cpu, 182)  HND_S(cpu, 183) \
    HND_S(cpu, 184)  HND_S(cpu, 185)  HND_S(cpu, 186)  HND_S(cpu, 187) \
    HND_S(cpu, 188)  HND_S(cpu, 189)  HND_S(cpu, 190)  HND_S(cpu, 191) \
    HND_S(cpu, 192)  HND_S(cpu, 193)  HND_S(cpu, 194)  HND_S(cpu, 195) \
    HND_S(cpu, 196)  HND_S(cpu, 197)  HND_S(cpu, 198)  HND_S(cpu, 199) \
    HND_S(cpu, 200)  HND_S(cpu, 201)  HND_S(cpu, 202)  HND_S(cpu, 203) \
    HND_S(cpu, 204)  HND_S(cpu, 205)  HND_S(cpu, 206)  HND_S(cpu, 207) \
    HND_S(cpu, 208)  HND_S(cpu, 209)  HND_S(cpu, 210)  HND_S(cpu, 211) \
    HND_S(cpu, 212)  HND_S(cpu, 213)  HND_S(cpu, 214)  HND_S(cpu, 215) \
    HND_S(cpu, 216)  HND_S(cpu, 217)  HND_S(cpu, 218)  HND_S(cpu, 219) \
    HND_S(cpu, 220)  HND_S(cpu, 221)  HND_S(cpu, 222)  HND_S(cpu, 223) \
    HND_S(cpu, 224)  HND_S(cpu, 225)  HND_S(cpu, 226)  HND_S(cpu, 227) \
    HND_S(cpu, 228)  HND_S(cpu, 229)  HND_S(cpu, 230)  HND_S(cpu, 231) \
    HND_S(cpu, 232)  HND_S(cpu, 233)  HND_S(cpu, 234)  HND_S(cpu, 235) \
    HND_S(cpu, 236)  HND_S(cpu, 237)  HND_S(cpu, 238)  HND_S(cpu, 239) \
    HND_S(cpu, 240)  HND_S(cpu, 241)  HND_S(cpu, 242)  HND_S(cpu, 243) \
    HND_S(cpu, 244)  HND_S(cpu, 245)  HND_S(cpu, 246)  HND_S(cpu, 247) \
    HND_S(cpu, 248)  HND_S(cpu, 249)  HND_S(cpu, 250)  HND_S(cpu, 251) \
    HND_S(cpu, 252)  HND_S(cpu, 253)  HND_S(cpu, 254)  HND_S(cpu, 255) \
    "    rslcx\n" \
    "    rfe\n" \
    ".popsection\n" \
  )


#if IFX_CFG_SSW_ENABLE_TRICORE0
INTTAB(0);
#endif

#if IFX_CFG_SSW_ENABLE_TRICORE1
INTTAB(1);
#endif

#if IFX_CFG_SSW_ENABLE_TRICORE2
INTTAB(2);
#endif

#if IFX_CFG_SSW_ENABLE_TRICORE3
INTTAB(3);
#endif

#if IFX_CFG_SSW_ENABLE_TRICORE4
INTTAB(4);
#endif

#if IFX_CFG_SSW_ENABLE_TRICORE5
INTTAB(5);
#endif

#endif
